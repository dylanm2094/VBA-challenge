Sub stock_tickers()   For Each ws In Worksheets        Sheets(ws.Name).Select        Range("O:O").Font.Bold = True        Range("O:O").HorizontalAlignment = xlCenter        Range("A1").EntireRow.Font.Bold = True        Range("A1").EntireRow.HorizontalAlignment = xlCenter        last_row = Cells(Rows.Count, 1).End(xlUp).Row        ticker = Cells(2, 1)        ticker_cnt = 0        tick_vol = 0        unique_ticker_row = 2        Cells(1, 9) = "Ticker"        Cells(1, 10) = "Yearly Change"        Cells(1, 11) = "Percent Change"        Cells(1, 12) = "Volume"                For i = 2 To last_row            If i = last_row Then                Cells(unique_ticker_row, 9) = Cells(i, 1)                first_tick = i - ticker_cnt                open_price = Cells(first_tick, 3)                close_price = Cells(i, 6)                Cells(unique_ticker_row, 10) = close_price - open_price                     If Cells(unique_ticker_row, 10) > 0 Then                        Cells(unique_ticker_row, 10).Interior.ColorIndex = 4                    ElseIf Cells(unique_ticker_row, 10) < 0 Then                        Cells(unique_ticker_row, 10).Interior.ColorIndex = 3                    End If                On Error Resume Next                If IsError(Cells(unique_ticker_row, 10) / open_price) Then                    perc_chg = "N/A"                Else: perc_chg = FormatPercent(Cells(unique_ticker_row, 10) / open_price)                End If                Cells(unique_ticker_row, 11) = perc_chg                Cells(unique_ticker_row, 12) = tick_vol + Cells(i, 7)            ElseIf Cells(i, 1) = ticker Then                ticker_cnt = ticker_cnt + 1                tick_vol = tick_vol + Cells(i, 7)            ElseIf Cells(i, 1) <> ticker Then                first_tick = i - ticker_cnt                last_tick = i - 1                Cells(unique_ticker_row, 9) = ticker                open_price = Cells(first_tick, 3)                close_price = Cells(last_tick, 6)                Cells(unique_ticker_row, 10) = close_price - open_price                     If Cells(unique_ticker_row, 10) > 0 Then                        Cells(unique_ticker_row, 10).Interior.ColorIndex = 4                    ElseIf Cells(unique_ticker_row, 10) < 0 Then                        Cells(unique_ticker_row, 10).Interior.ColorIndex = 3                    End If                On Error Resume Next                If IsError(Cells(unique_ticker_row, 10) / open_price) Then                    perc_chg = "N/A"                Else: perc_chg = FormatPercent(Cells(unique_ticker_row, 10) / open_price)                End If                Cells(unique_ticker_row, 11) = perc_chg                Cells(unique_ticker_row, 12) = tick_vol                ticker = Cells(i, 1)                ticker_cnt = 1                unique_ticker_row = unique_ticker_row + 1                tick_vol = Cells(i, 7)            End If        Next i                Cells(2, 15) = "Greatest Percent Increase"        Cells(3, 15) = "Greatest Percent Dencrease"        Cells(4, 15) = "Greatest Total Volume"        Cells(2, 17) = FormatPercent(Application.WorksheetFunction.Max(Range("K:K")))        Cells(3, 17) = FormatPercent(Application.WorksheetFunction.Min(Range("K:K")))        Cells(4, 17) = Application.WorksheetFunction.Max(Range("L:L"))                 For i = 2 To unique_ticker_row                If Cells(i, 11) = Cells(2, 17) Then                    Cells(2, 16) = Cells(i, 9)                End If         Next i                  For i = 2 To unique_ticker_row                If Cells(i, 11) = Cells(3, 17) Then                    Cells(3, 16) = Cells(i, 9)                End If         Next i                  For i = 2 To unique_ticker_row                If Cells(i, 12) = Cells(4, 17) Then                    Cells(4, 16) = Cells(i, 9)                End If         Next i            Next ws        End Sub